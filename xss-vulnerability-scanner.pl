use LWP::UserAgent;
use HTML::TokeParser;

my $url = shift @ARGV;

if (!$url) {
    die "Usage: perl xss_scanner.pl URL\n";
}

# Create a user agent object
my $ua = LWP::UserAgent->new;

# Send a request to the URL
my $response = $ua->get($url);

# Check that the request was successful
if (!$response->is_success) {
    die "Error: " . $response->status_line . "\n";
}

# Parse the response content
my $stream = HTML::TokeParser->new(\$response->decoded_content);

# Search for HTML tags that might contain user input
while (my $token = $stream->get_token) {
    if ($token->[0] eq 'S' && $token->[1] =~ /^(?:input|textarea|select|script)/i) {
        # Check for attributes that might allow user input
        my $attributes = $token->[2];
        if (grep { lc($_) eq 'value' || lc($_) eq 'name' } keys %$attributes) {
            print "Possible XSS vulnerability found at $url\n";
            last;
        }
    }
}

